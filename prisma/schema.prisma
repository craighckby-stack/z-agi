// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// Binary processing units
model BinaryUnit {
  id          String   @id @default(cuid())
  unitType    String   // 'PROCESSOR' | 'ANALYZER' | 'VALIDATOR' | 'OPTIMIZER'
  version     String   @default("1.0.0")
  status      String   @default("ACTIVE") // 'ACTIVE' | 'INACTIVE' | 'ERROR'
  config      Json     // Unit configuration parameters
  metrics     Json     // Performance metrics
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Binary data packets
model DataPacket {
  id          String   @id @default(cuid())
  packetType  String   // 'INPUT' | 'OUTPUT' | 'METADATA' | 'SIGNAL'
  source      String   // Source unit ID
  target      String?  // Target unit ID
  payload     Json     // Binary data payload
  size        Int      @default(0) // Payload size in bytes
  checksum    String   @default("") // Data integrity checksum
  processed   Boolean  @default(false)
  createdAt   DateTime @default(now())
  processedAt DateTime?
}

// Binary logic gates
model LogicGate {
  id          String   @id @default(cuid())
  gateType    String   // 'AND' | 'OR' | 'NOT' | 'XOR' | 'NAND' | 'NOR'
  inputs      Int      @default(2) // Number of inputs
  output      String   // Output state '0' or '1'
  truthTable  Json     // Truth table configuration
  config      Json     // Gate configuration
  status      String   @default("ACTIVE") // 'ACTIVE' | 'INACTIVE'
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Binary processing rules
model ProcessingRule {
  id          String   @id @default(cuid())
  ruleType    String   // 'FILTER' | 'TRANSFORM' | 'ROUTE' | 'AGGREGATE'
  condition   Json     // Binary condition expression
  action      Json     // Binary action to execute
  priority    Int      @default(0)
  active      Boolean  @default(true)
  executions  Int      @default(0)
  successRate Float    @default(0.0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Binary system state
model SystemState {
  id          String   @id @default(cuid())
  stateType   String   // 'GLOBAL' | 'UNIT' | 'NETWORK'
  stateKey    String   // State identifier
  stateValue  Json     // Binary state data
  version     Int      @default(1)
  checksum    String   @default("") // State integrity checksum
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Binary network connections
model NetworkConnection {
  id          String   @id @default(cuid())
  sourceId    String   // Source unit ID
  targetId    String   // Target unit ID
  connectionType String // 'DATA' | 'CONTROL' | 'FEEDBACK'
  bandwidth   Int      @default(1000) // Max data rate
  latency     Int      @default(0) // Processing latency
  active      Boolean  @default(true)
  packetCount Int      @default(0) // Total packets transmitted
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Binary operations log
model OperationLog {
  id          String   @id @default(cuid())
  operationId String   // Unique operation identifier
  unitId      String   // Processing unit ID
  operation   String   // 'PROCESS' | 'ANALYZE' | 'VALIDATE' | 'OPTIMIZE'
  input       Json     // Input data
  output      Json     // Output data
  cycles      Int      @default(0) // Processing cycles used
  status      String   // 'SUCCESS' | 'ERROR' | 'TIMEOUT'
  errorCode   String?  // Error code if failed
  duration    Int      @default(0) // Duration in milliseconds
  createdAt   DateTime @default(now())
}